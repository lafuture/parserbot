<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>bot API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>bot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="bot.cmd_start"><code class="name flex">
<span>async def <span class="ident">cmd_start</span></span>(<span>message:¬†aiogram.types.message.Message)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def cmd_start(message: Message):
    &#34;&#34;&#34;
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /start –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π.

    :param message: –í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–º–∞–Ω–¥–æ–π /start.
    :type message: Message
    &#34;&#34;&#34;
    try:
        state = get_state(message.chat.id)
        text = (
            &#34;–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π —à–ª—ë—Ç –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å –ê–≤–∏—Ç–æ.\n\n&#34;
            &#34;–ù–∞—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä—ã –∏ –∑–∞–ø—É—Å—Ç–∏ –ø–æ–∏—Å–∫!&#34;
        )
        await message.answer(text, reply_markup=main_keyboard(state))
    except Exception as e:
        print(f&#34;[cmd_start] –û—à–∏–±–∫–∞: {e}&#34;)
        try:
            await message.answer(&#34;–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.&#34;)
        except Exception:
            pass</code></pre>
</details>
<div class="desc"><p>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /start –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π.</p>
<p>:param message: –í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–º–∞–Ω–¥–æ–π /start.
:type message: Message</p></div>
</dd>
<dt id="bot.get_state"><code class="name flex">
<span>def <span class="ident">get_state</span></span>(<span>chat_id:¬†int) ‚Äë>¬†<a title="bot.UserState" href="#bot.UserState">UserState</a></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_state(chat_id: int) -&gt; UserState:
    &#34;&#34;&#34;
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ chat_id,
    —Å–æ–∑–¥–∞–≤–∞—è –µ–≥–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏.

    :param chat_id: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —á–∞—Ç–∞ Telegram.
    :type chat_id: int
    :returns: –û–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —á–∞—Ç–∞.
    :rtype: UserState
    &#34;&#34;&#34;
    if chat_id not in user_states:
        user_states[chat_id] = UserState()
    return user_states[chat_id]</code></pre>
</details>
<div class="desc"><p>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ chat_id,
—Å–æ–∑–¥–∞–≤–∞—è –µ–≥–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏.</p>
<p>:param chat_id: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —á–∞—Ç–∞ Telegram.
:type chat_id: int
:returns: –û–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —á–∞—Ç–∞.
:rtype: UserState</p></div>
</dd>
<dt id="bot.main"><code class="name flex">
<span>async def <span class="ident">main</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def main():
    &#34;&#34;&#34;
    –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ë–î, —Å–æ–∑–¥–∞—ë—Ç –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä
    –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç long polling.

    :raises RuntimeError: –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è TELEGRAM_TOKEN –Ω–µ –∑–∞–¥–∞–Ω–∞.
    &#34;&#34;&#34;
    try:
        args = parse_arguments()

        if args.env_file:
            load_dotenv(args.env_file)
        else:
            load_dotenv()

        CONFIG[&#39;token&#39;] = args.token or os.getenv(&#34;TELEGRAM_TOKEN&#34;)
        CONFIG[&#39;db_url&#39;] = args.db_url or os.getenv(&#34;DB_URL&#34;)
        CONFIG[&#39;check_interval&#39;] = args.check_interval
        CONFIG[&#39;search_limit&#39;] = args.search_limit

        if args.db_url:
            os.environ[&#34;DB_URL&#34;] = args.db_url

        if not CONFIG[&#39;token&#39;]:
            raise RuntimeError(
                &#34;TELEGRAM_TOKEN –Ω–µ –∑–∞–¥–∞–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ --token –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ .env —Ñ–∞–π–ª–µ&#34;
            )

        print(f&#34;[bot] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:&#34;)
        print(f&#34;  - Check interval: {CONFIG[&#39;check_interval&#39;]}s&#34;)
        print(f&#34;  - Search limit: {CONFIG[&#39;search_limit&#39;]}&#34;)
        print(f&#34;  - Env file: {args.env_file}&#34;)

        init_db()
        print(&#34;[bot] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞&#34;)

        bot = Bot(token=CONFIG[&#39;token&#39;])
        dp = Dispatcher()

        dp.message.register(cmd_start, Command(&#34;start&#34;))
        dp.callback_query.register(
            on_callback,
            F.data.in_({&#34;set_price&#34;, &#34;set_rooms&#34;, &#34;start_search&#34;, &#34;stop_search&#34;}),
        )
        dp.message.register(on_message, F.text)

        print(&#34;[bot] –ó–∞–ø—É—Å–∫ polling...&#34;)
        await dp.start_polling(bot)

    except Exception as e:
        print(f&#34;[bot] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}&#34;)
        raise RuntimeError(f&#34;–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: {e}&#34;)</code></pre>
</details>
<div class="desc"><p>–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ë–î, —Å–æ–∑–¥–∞—ë—Ç –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä
–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç long polling.</p>
<p>:raises RuntimeError: –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è TELEGRAM_TOKEN –Ω–µ –∑–∞–¥–∞–Ω–∞.</p></div>
</dd>
<dt id="bot.main_keyboard"><code class="name flex">
<span>def <span class="ident">main_keyboard</span></span>(<span>state:¬†<a title="bot.UserState" href="#bot.UserState">UserState</a>) ‚Äë>¬†aiogram.types.inline_keyboard_markup.InlineKeyboardMarkup</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def main_keyboard(state: UserState) -&gt; InlineKeyboardMarkup:
    &#34;&#34;&#34;
    –°—Ç—Ä–æ–∏—Ç –æ—Å–Ω–æ–≤–Ω—É—é inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.
    –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–µ–Ω—ã, –≤—ã–±–æ—Ä–∞
    –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–Ω–∞—Ç –∏ –∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞.

    :param state: –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    :type state: UserState
    :returns: –û–±—ä–µ–∫—Ç inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é.
    :rtype: InlineKeyboardMarkup
    &#34;&#34;&#34;
    if state.min_price or state.max_price:
        parts = []
        if state.min_price:
            parts.append(f&#34;–æ—Ç {state.min_price}&#34;)
        if state.max_price:
            parts.append(f&#34;–¥–æ {state.max_price}&#34;)
        price_text = &#34;üí≤ –¶–µ–Ω–∞: &#34; + &#34; &#34;.join(parts)
    else:
        price_text = &#34;üí≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É&#34;

    if state.rooms:
        rooms_str = &#34;, &#34;.join(
            [&#34;—Å—Ç—É–¥–∏—è&#34; if r == 0 else f&#34;{r}&#34; for r in state.rooms]
        )
        rooms_text = &#34;üè† –ö–æ–º–Ω–∞—Ç—ã: &#34; + rooms_str
    else:
        rooms_text = &#34;üè† –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–Ω–∞—Ç—ã&#34;

    kb = [
        [InlineKeyboardButton(text=price_text, callback_data=&#34;set_price&#34;)],
        [InlineKeyboardButton(text=rooms_text, callback_data=&#34;set_rooms&#34;)],
        [InlineKeyboardButton(text=&#34;‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫&#34;, callback_data=&#34;start_search&#34;)],
    ]
    return InlineKeyboardMarkup(inline_keyboard=kb)</code></pre>
</details>
<div class="desc"><p>–°—Ç—Ä–æ–∏—Ç –æ—Å–Ω–æ–≤–Ω—É—é inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.
–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–µ–Ω—ã, –≤—ã–±–æ—Ä–∞
–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–Ω–∞—Ç –∏ –∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞.</p>
<p>:param state: –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
:type state: UserState
:returns: –û–±—ä–µ–∫—Ç inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é.
:rtype: InlineKeyboardMarkup</p></div>
</dd>
<dt id="bot.on_callback"><code class="name flex">
<span>async def <span class="ident">on_callback</span></span>(<span>callback:¬†aiogram.types.callback_query.CallbackQuery,<br>bot:¬†aiogram.client.bot.Bot)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def on_callback(callback: CallbackQuery, bot: Bot):
    &#34;&#34;&#34;
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ inline-–∫–Ω–æ–ø–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ–Ω—é –±–æ—Ç–∞.
    –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç callback_data –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º
    –≤–≤–æ–¥–∞ —Ü–µ–Ω—ã –∏–ª–∏ –∫–æ–º–Ω–∞—Ç, –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–∏—Å–∫.

    :param callback: –û–±—ä–µ–∫—Ç callback-–∑–∞–ø—Ä–æ—Å–∞ –æ—Ç Telegram.
    :type callback: CallbackQuery
    :param bot: –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
    :type bot: Bot
    &#34;&#34;&#34;
    try:
        chat_id = callback.message.chat.id
        state = get_state(chat_id)

        if callback.data == &#34;set_price&#34;:
            state.waiting_for_price = True
            state.waiting_for_rooms = False
            await callback.message.answer(
                &#34;–í–≤–µ–¥–∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:\n&#34;
                &#34;30000-60000\n&#34;
                &#34;–ò–ª–∏ —Ç–æ–ª—å–∫–æ –º–∏–Ω–∏–º—É–º, –Ω–∞–ø—Ä–∏–º–µ—Ä:\n&#34;
                &#34;40000&#34;
            )
            await callback.answer()
            return

        if callback.data == &#34;set_rooms&#34;:
            state.waiting_for_rooms = True
            state.waiting_for_price = False
            await callback.message.answer(
                &#34;–í–≤–µ–¥–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.\n&#34;
                &#34;–ü—Ä–∏–º–µ—Ä—ã:\n&#34;
                &#34;—Å—Ç—É–¥–∏—è –∏ 1-2–∫: 0,1,2\n&#34;
                &#34;—Ç–æ–ª—å–∫–æ 2 –∏ 3–∫: 2,3&#34;
            )
            await callback.answer()
            return

        if callback.data == &#34;start_search&#34;:
            if state.searching:
                await callback.answer(&#34;–ü–æ–∏—Å–∫ —É–∂–µ –∑–∞–ø—É—â–µ–Ω&#34;, show_alert=True)
                return

            state.searching = True
            state.since = datetime.now(UTC) - timedelta(minutes=4)
            await callback.message.answer(
                &#34;–ü–æ–∏—Å–∫ –∑–∞–ø—É—â–µ–Ω.\n&#34;
                &#34;–ë—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.&#34;,
                reply_markup=stop_keyboard()
            )
            await callback.answer()
            asyncio.create_task(search_loop(bot, chat_id))
            return

        if callback.data == &#34;stop_search&#34;:
            if not state.searching:
                await callback.answer(&#34;–ü–æ–∏—Å–∫ —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω&#34;)
                return

            state.searching = False
            await callback.message.answer(&#34;–ü–æ–∏—Å–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.&#34;)
            await callback.answer()
            return

        await callback.answer(&#34;–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞&#34;)

    except Exception as e:
        print(f&#34;[on_callback] –û—à–∏–±–∫–∞: {e}&#34;)
        try:
            await callback.answer(&#34;–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞&#34;, show_alert=True)
        except Exception:
            pass</code></pre>
</details>
<div class="desc"><p>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ inline-–∫–Ω–æ–ø–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ–Ω—é –±–æ—Ç–∞.
–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç callback_data –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º
–≤–≤–æ–¥–∞ —Ü–µ–Ω—ã –∏–ª–∏ –∫–æ–º–Ω–∞—Ç, –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–∏—Å–∫.</p>
<p>:param callback: –û–±—ä–µ–∫—Ç callback-–∑–∞–ø—Ä–æ—Å–∞ –æ—Ç Telegram.
:type callback: CallbackQuery
:param bot: –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
:type bot: Bot</p></div>
</dd>
<dt id="bot.on_message"><code class="name flex">
<span>async def <span class="ident">on_message</span></span>(<span>message:¬†aiogram.types.message.Message)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def on_message(message: Message):
    &#34;&#34;&#34;
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç
    —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –≤–≤–æ–¥ —Ü–µ–Ω—ã, –∫–æ–º–Ω–∞—Ç –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É /start.

    :param message: –í—Ö–æ–¥—è—â–µ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    :type message: Message
    &#34;&#34;&#34;
    try:
        chat_id = message.chat.id
        state = get_state(chat_id)

        if message.text == &#34;/start&#34;:
            await cmd_start(message)
            return

        if state.waiting_for_price:
            try:
                raw = message.text.replace(&#34; &#34;, &#34;&#34;)
                min_p = None
                max_p = None

                if &#34;-&#34; in raw:
                    left, right = raw.split(&#34;-&#34;, maxsplit=1)
                    if left:
                        try:
                            min_p = int(left)
                        except ValueError:
                            min_p = None
                    if right:
                        try:
                            max_p = int(right)
                        except ValueError:
                            max_p = None
                else:
                    try:
                        min_p = int(raw)
                    except ValueError:
                        min_p = None

                state.min_price = min_p
                state.max_price = max_p
                state.waiting_for_price = False

                await message.answer(
                    f&#34;–§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ –æ–±–Ω–æ–≤–ª—ë–Ω.\n&#34;
                    f&#34;–ú–∏–Ω–∏–º—É–º: {state.min_price or &#39;‚Äî&#39;}\n&#34;
                    f&#34;–ú–∞–∫—Å–∏–º—É–º: {state.max_price or &#39;‚Äî&#39;}&#34;,
                    reply_markup=main_keyboard(state),
                )
            except Exception as e:
                print(f&#34;[on_message] –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ü–µ–Ω—ã: {e}&#34;)
                await message.answer(&#34;–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.&#34;)
            return

        if state.waiting_for_rooms:
            try:
                raw = message.text.replace(&#34; &#34;, &#34;&#34;)
                rooms_list: list[int] = []

                if raw:
                    for part in raw.split(&#34;,&#34;):
                        if not part:
                            continue
                        try:
                            val = int(part)
                            rooms_list.append(val)
                        except ValueError:
                            continue

                state.rooms = rooms_list or None
                state.waiting_for_rooms = False

                if state.rooms:
                    rooms_str = &#34;, &#34;.join(
                        [&#34;—Å—Ç—É–¥–∏—è&#34; if r == 0 else f&#34;{r}&#34; for r in state.rooms]
                    )
                    txt = f&#34;–§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º –æ–±–Ω–æ–≤–ª—ë–Ω.\n–ö–æ–º–Ω–∞—Ç—ã: {rooms_str}&#34;
                else:
                    txt = &#34;–§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º —Å–±—Ä–æ—à–µ–Ω.&#34;

                await message.answer(txt, reply_markup=main_keyboard(state))
            except Exception as e:
                print(f&#34;[on_message] –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–Ω–∞—Ç: {e}&#34;)
                await message.answer(&#34;–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.&#34;)
            return

        await message.answer(&#34;–ò—Å–ø–æ–ª—å–∑—É–π /start –¥–ª—è –Ω–∞—á–∞–ª–∞.&#34;)

    except Exception as e:
        print(f&#34;[on_message] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}&#34;)
        try:
            await message.answer(&#34;–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ /start&#34;)
        except Exception:
            pass</code></pre>
</details>
<div class="desc"><p>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç
—Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –≤–≤–æ–¥ —Ü–µ–Ω—ã, –∫–æ–º–Ω–∞—Ç –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É /start.</p>
<p>:param message: –í—Ö–æ–¥—è—â–µ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
:type message: Message</p></div>
</dd>
<dt id="bot.parse_arguments"><code class="name flex">
<span>def <span class="ident">parse_arguments</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def parse_arguments():
    &#34;&#34;&#34;
    –ü–∞—Ä—Å–∏—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞.

    :returns: –û–±—ä–µ–∫—Ç —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
    :rtype: argparse.Namespace
    &#34;&#34;&#34;
    parser = argparse.ArgumentParser(
        description=&#39;Telegram –±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&#39;,
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog=&#34;&#34;&#34;
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
  # –ó–∞–ø—É—Å–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ .env)
  python bot.py

  # –ó–∞–ø—É—Å–∫ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–∞
  python bot.py --token &#34;YOUR_BOT_TOKEN&#34;

  # –ó–∞–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ë–î –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
  python bot.py --db-url &#34;postgres://user:pass@localhost/db&#34; --check-interval 60

  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ .env —Ñ–∞–π–ª–∞
  python bot.py --env-file /path/to/.env
        &#34;&#34;&#34;
    )

    parser.add_argument(
        &#39;--token&#39;,
        type=str,
        help=&#39;–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç TELEGRAM_TOKEN –∏–∑ .env)&#39;
    )

    parser.add_argument(
        &#39;--db-url&#39;,
        type=str,
        help=&#39;URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç DB_URL –∏–∑ .env)&#39;
    )

    parser.add_argument(
        &#39;--env-file&#39;,
        type=str,
        default=&#39;.env&#39;,
        help=&#39;–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: .env)&#39;
    )

    parser.add_argument(
        &#39;--check-interval&#39;,
        type=int,
        default=30,
        help=&#39;–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 30)&#39;
    )

    parser.add_argument(
        &#39;--search-limit&#39;,
        type=int,
        default=100,
        help=&#39;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100)&#39;
    )

    return parser.parse_args()</code></pre>
</details>
<div class="desc"><p>–ü–∞—Ä—Å–∏—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞.</p>
<p>:returns: –û–±—ä–µ–∫—Ç —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
:rtype: argparse.Namespace</p></div>
</dd>
<dt id="bot.search_loop"><code class="name flex">
<span>async def <span class="ident">search_loop</span></span>(<span>bot:¬†aiogram.client.bot.Bot, chat_id:¬†int)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def search_loop(bot: Bot, chat_id: int):
    &#34;&#34;&#34;
    –¶–∏–∫–ª —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π,
    —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —á–∞—Ç.

    :param bot: –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
    :type bot: Bot
    :param chat_id: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —á–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    :type chat_id: int
    &#34;&#34;&#34;
    state = get_state(chat_id)

    try:
        if state.since is None:
            state.since = datetime.now(UTC)
        elif state.since.tzinfo is None:
            state.since = state.since.replace(tzinfo=UTC)

        print(f&#34;[search_loop] –°–¢–ê–†–¢ –¥–ª—è —á–∞—Ç–∞ {chat_id}, since={state.since!r}&#34;)
        print(f&#34;[search_loop] –§–∏–ª—å—Ç—Ä—ã: min={state.min_price}, max={state.max_price}, rooms={state.rooms}&#34;)

        while state.searching:
            try:
                ads = get_new_aparts(
                    min_price=state.min_price,
                    max_price=state.max_price,
                    rooms=state.rooms,
                    since=state.since,
                    limit=CONFIG[&#39;search_limit&#39;],
                )

                print(f&#34;[search_loop] since={state.since!r}, –Ω–∞–π–¥–µ–Ω–æ {len(ads)} –æ–±—ä—è–≤–ª–µ–Ω–∏–π&#34;)

                if len(ads) == CONFIG[&#39;search_limit&#39;]:
                    print(f&#34;[WARNING] –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç {CONFIG[&#39;search_limit&#39;]}! –í–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å –µ—â–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è!&#34;)

                if ads:
                    for ad in ads:
                        try:
                            text = (
                                f&#34;–¶–µ–Ω–∞: {ad[&#39;price&#39;]} ‚ÇΩ\n&#34;
                                f&#34;–ö–æ–º–Ω–∞—Ç: {ad[&#39;rooms&#39;]}\n&#34;
                                f&#34;{ad[&#39;title&#39;]}\n&#34;
                                f&#34;{ad[&#39;link&#39;]}&#34;
                            )
                            await bot.send_message(chat_id, text, reply_markup=stop_keyboard())
                        except Exception as e:
                            print(f&#34;[search_loop] –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}&#34;)

                    max_created_at = max(ad[&#34;created_at&#34;] for ad in ads)
                    if max_created_at.tzinfo is None:
                        max_created_at = max_created_at.replace(tzinfo=UTC)
                    state.since = max_created_at
                    print(f&#34;[search_loop] –æ–±–Ω–æ–≤–ª–µ–Ω since –¥–æ {state.since!r}&#34;)

                await asyncio.sleep(CONFIG[&#39;check_interval&#39;])

            except Exception as e:
                print(f&#34;[search_loop] –æ—à–∏–±–∫–∞ –≤ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —á–∞—Ç–∞ {chat_id}: {e}&#34;)
                await asyncio.sleep(CONFIG[&#39;check_interval&#39;])

        print(f&#34;[search_loop] –≤—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ –¥–ª—è —á–∞—Ç–∞ {chat_id}&#34;)

    except Exception as e:
        print(f&#34;[search_loop] –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è —á–∞—Ç–∞ {chat_id}: {e}&#34;)
        try:
            await bot.send_message(
                chat_id,
                &#34;–ü—Ä–æ–∏–∑–æ—à–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ø–æ–∏—Å–∫–µ. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–∏—Å–∫.&#34;
            )
        except Exception:
            pass</code></pre>
</details>
<div class="desc"><p>–¶–∏–∫–ª —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π,
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —á–∞—Ç.</p>
<p>:param bot: –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
:type bot: Bot
:param chat_id: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —á–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
:type chat_id: int</p></div>
</dd>
<dt id="bot.stop_keyboard"><code class="name flex">
<span>def <span class="ident">stop_keyboard</span></span>(<span>) ‚Äë>¬†aiogram.types.inline_keyboard_markup.InlineKeyboardMarkup</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stop_keyboard() -&gt; InlineKeyboardMarkup:
    &#34;&#34;&#34;
    –°—Ç—Ä–æ–∏—Ç inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–∏—Å–∫–∞.

    :returns: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–æ–π ¬´–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫¬ª.
    :rtype: InlineKeyboardMarkup
    &#34;&#34;&#34;
    return InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text=&#34;‚õî –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫&#34;, callback_data=&#34;stop_search&#34;)]
        ]
    )</code></pre>
</details>
<div class="desc"><p>–°—Ç—Ä–æ–∏—Ç inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–∏—Å–∫–∞.</p>
<p>:returns: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–æ–π ¬´–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫¬ª.
:rtype: InlineKeyboardMarkup</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="bot.UserState"><code class="flex name class">
<span>class <span class="ident">UserState</span></span>
<span>(</span><span>waiting_for_price:¬†bool¬†=¬†False,<br>min_price:¬†int¬†|¬†None¬†=¬†None,<br>max_price:¬†int¬†|¬†None¬†=¬†None,<br>waiting_for_rooms:¬†bool¬†=¬†False,<br>rooms:¬†list[int]¬†|¬†None¬†=¬†None,<br>searching:¬†bool¬†=¬†False,<br>since:¬†datetime.datetime¬†|¬†None¬†=¬†None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class UserState:
    &#34;&#34;&#34;
    –•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞:
    –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.

    :ivar waiting_for_price: –û–∂–∏–¥–∞–µ—Ç—Å—è –ª–∏ –≤–≤–æ–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–µ–Ω—ã.
    :type waiting_for_price: bool
    :ivar min_price: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–∞.
    :type min_price: int | None
    :ivar max_price: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–∞.
    :type max_price: int | None
    :ivar waiting_for_rooms: –û–∂–∏–¥–∞–µ—Ç—Å—è –ª–∏ –≤–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–Ω–∞—Ç.
    :type waiting_for_rooms: bool
    :ivar rooms: –°–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–º–Ω–∞—Ç (0 = —Å—Ç—É–¥–∏—è).
    :type rooms: list[int] | None
    :ivar searching: –ü—Ä–∏–∑–Ω–∞–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.
    :type searching: bool
    :ivar since: –ú–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ—Ç–æ—Ä–æ–π –∏—â—É—Ç—Å—è –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.
    :type since: datetime | None
    &#34;&#34;&#34;
    waiting_for_price: bool = False
    min_price: int | None = None
    max_price: int | None = None
    waiting_for_rooms: bool = False
    rooms: list[int] | None = None
    searching: bool = False
    since: datetime | None = None</code></pre>
</details>
<div class="desc"><p>–•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞:
–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.</p>
<p>:ivar waiting_for_price: –û–∂–∏–¥–∞–µ—Ç—Å—è –ª–∏ –≤–≤–æ–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ü–µ–Ω—ã.
:type waiting_for_price: bool
:ivar min_price: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–∞.
:type min_price: int | None
:ivar max_price: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–∞.
:type max_price: int | None
:ivar waiting_for_rooms: –û–∂–∏–¥–∞–µ—Ç—Å—è –ª–∏ –≤–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–Ω–∞—Ç.
:type waiting_for_rooms: bool
:ivar rooms: –°–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–º–Ω–∞—Ç (0 = —Å—Ç—É–¥–∏—è).
:type rooms: list[int] | None
:ivar searching: –ü—Ä–∏–∑–Ω–∞–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.
:type searching: bool
:ivar since: –ú–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ—Ç–æ—Ä–æ–π –∏—â—É—Ç—Å—è –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.
:type since: datetime | None</p></div>
<h3>Instance variables</h3>
<dl>
<dt id="bot.UserState.max_price"><code class="name">var <span class="ident">max_price</span> :¬†int¬†|¬†None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.min_price"><code class="name">var <span class="ident">min_price</span> :¬†int¬†|¬†None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.rooms"><code class="name">var <span class="ident">rooms</span> :¬†list[int]¬†|¬†None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.searching"><code class="name">var <span class="ident">searching</span> :¬†bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.since"><code class="name">var <span class="ident">since</span> :¬†datetime.datetime¬†|¬†None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.waiting_for_price"><code class="name">var <span class="ident">waiting_for_price</span> :¬†bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="bot.UserState.waiting_for_rooms"><code class="name">var <span class="ident">waiting_for_rooms</span> :¬†bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="bot.cmd_start" href="#bot.cmd_start">cmd_start</a></code></li>
<li><code><a title="bot.get_state" href="#bot.get_state">get_state</a></code></li>
<li><code><a title="bot.main" href="#bot.main">main</a></code></li>
<li><code><a title="bot.main_keyboard" href="#bot.main_keyboard">main_keyboard</a></code></li>
<li><code><a title="bot.on_callback" href="#bot.on_callback">on_callback</a></code></li>
<li><code><a title="bot.on_message" href="#bot.on_message">on_message</a></code></li>
<li><code><a title="bot.parse_arguments" href="#bot.parse_arguments">parse_arguments</a></code></li>
<li><code><a title="bot.search_loop" href="#bot.search_loop">search_loop</a></code></li>
<li><code><a title="bot.stop_keyboard" href="#bot.stop_keyboard">stop_keyboard</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="bot.UserState" href="#bot.UserState">UserState</a></code></h4>
<ul class="two-column">
<li><code><a title="bot.UserState.max_price" href="#bot.UserState.max_price">max_price</a></code></li>
<li><code><a title="bot.UserState.min_price" href="#bot.UserState.min_price">min_price</a></code></li>
<li><code><a title="bot.UserState.rooms" href="#bot.UserState.rooms">rooms</a></code></li>
<li><code><a title="bot.UserState.searching" href="#bot.UserState.searching">searching</a></code></li>
<li><code><a title="bot.UserState.since" href="#bot.UserState.since">since</a></code></li>
<li><code><a title="bot.UserState.waiting_for_price" href="#bot.UserState.waiting_for_price">waiting_for_price</a></code></li>
<li><code><a title="bot.UserState.waiting_for_rooms" href="#bot.UserState.waiting_for_rooms">waiting_for_rooms</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
